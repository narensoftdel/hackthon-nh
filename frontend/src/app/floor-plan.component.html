<div class="container">
      <div class="header">
        <h1 class="title">
          <svg class="icon-alert" viewBox="0 0 24 24" fill="currentColor">
            <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3ZM12 9v4m0 4h.01"/>
          </svg>
          Emergency Exit Navigation System
        </h1>
        <p class="subtitle">
          Interactive floor plan with smart exit routing and fire hazard detection
        </p>
      </div>

      <div class="main-grid">
        <div class="canvas-section">
          <div class="canvas-container">
            <canvas 
              #floorPlanCanvas 
              width="520" 
              height="400"
              class="floor-plan-canvas"
              (click)="handleCanvasClick($event)">
            </canvas>
          </div>
          
          <div class="tip">
            <p>ðŸ’¡ <strong>Tip:</strong> Click anywhere on the floor plan to move your position</p>
          </div>
        </div>

        <div class="controls-section">
          <div class="control-panel navigation-panel">
            <h3 class="panel-title">
              <svg class="panel-icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="m3 11 19-9v2.75l-9 4.16v9.34l6-2.25V18L3 11Z"/>
              </svg>
              Navigation Controls
            </h3>
            
            <div class="button-group">
              <button
                (click)="startNavigation()"
                [disabled]="isNavigating"
                class="btn btn-emergency"
                [class.btn-disabled]="isNavigating">
                <svg *ngIf="!isNavigating" class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="m8 5 6 6-6 6V5Z"/>
                </svg>
                <svg *ngIf="isNavigating" class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
                  <rect width="6" height="6" x="9" y="9"/>
                </svg>
                {{ isNavigating ? 'Navigating...' : 'Start Emergency Exit' }}
              </button>
              
              <button
                (click)="resetNavigation()"
                class="btn btn-secondary">
                <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                  <path d="M21 3v5h-5M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                  <path d="M8 16H3v5"/>
                </svg>
                Reset Navigation
              </button>
              
              <button
                (click)="toggleAllRoutes()"
                class="btn btn-warning">
                <svg *ngIf="!showAllRoutes" class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8Z"/>
                  <circle cx="12" cy="12" r="3"/>
                </svg>
                <svg *ngIf="showAllRoutes" class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/>
                  <path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 11 8 11 8a13.16 13.16 0 0 1-1.67 2.68"/>
                  <path d="M6.61 6.61A13.526 13.526 0 0 0 1 12s4 8 11 8a9.74 9.74 0 0 0 5.39-1.61"/>
                  <line x1="2" x2="22" y1="2" y2="22"/>
                </svg>
                {{ showAllRoutes ? 'Hide All Routes' : 'Show All Routes' }}
              </button>
            </div>
          </div>

          <div class="control-panel status-panel">
            <h3 class="panel-title">
              <svg class="panel-icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"/>
                <circle cx="12" cy="10" r="3"/>
              </svg>
              Current Status
            </h3>
            
            <div class="status-info">
              <div class="status-row">
                <span>Position:</span>
                <span class="status-value">
                  {{ Math.round(userPosition.x) }}, {{ Math.round(userPosition.y) }}
                </span>
              </div>
              
              <div class="status-row">
                <span>Nearest Exit:</span>
                <span class="status-value status-success">
                  {{ getNearestExit().label }}
                </span>
              </div>
              
              <div class="status-row">
                <span>Safest Route:</span>
                <span class="status-value status-info">
                  {{ getSafestExit().label }}
                </span>
              </div>
            </div>
          </div>

          <div class="control-panel fire-panel">
            <h3 class="panel-title">
              <svg class="panel-icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5Z"/>
              </svg>
              Fire Hazards
            </h3>
            
            <div class="fire-controls">
              <div *ngFor="let fire of fireLocations" class="fire-item">
                <span class="fire-info">
                  Fire {{ fire.id }} ({{ fire.x }}, {{ fire.y }})
                </span>
                <button
                  (click)="toggleFire(fire.id)"
                  class="fire-toggle"
                  [class.fire-active]="fire.active"
                  [class.fire-inactive]="!fire.active">
                  {{ fire.active ? 'Active' : 'Inactive' }}
                </button>
              </div>
            </div>
          </div>

          <div class="control-panel legend-panel">
            <h3 class="panel-title">Legend</h3>
            <div class="legend-items">
              <div class="legend-item">
                <div class="legend-icon legend-user"></div>
                <span>Your Location</span>
              </div>
              <div class="legend-item">
                <div class="legend-icon legend-exit"></div>
                <span>Emergency Exits</span>
              </div>
              <div class="legend-item">
                <div class="legend-icon legend-fire"></div>
                <span>Fire Hazard</span>
              </div>
              <div class="legend-item">
                <div class="legend-icon legend-route"></div>
                <span>Safest Route</span>
              </div>
              <div class="legend-item">
                <div class="legend-icon legend-all-routes"></div>
                <span>All Exit Routes</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="isNavigating" class="navigation-alert">
        <div class="alert-content">
          <svg class="alert-icon" viewBox="0 0 24 24" fill="currentColor">
            <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3ZM12 9v4m0 4h.01"/>
          </svg>
          <div class="alert-text">
            <h4 class="alert-title">Emergency Navigation Active</h4>
            <p class="alert-message">
              Follow the highlighted red path to the safest exit. 
              Step {{ currentStep + 1 }} of {{ getSafestRoute().route.length }}
            </p>
          </div>
        </div>
      </div>
    </div>